---
openapi: 3.0.0
info:
  title: Sapper API
  description: This is a documentation for the API for the game Sapper with microtransactions
  version: 1.0.0
servers:
  - url: https://sapper-api.onrender.com
paths:
  "/health":
    get:
      summary: Check API health
      tags:
        - general
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    enum:
                      - ok
                  timing:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                    enum:
                      - db error
  "/login":
    post:
      summary: User login
      tags:
        - general
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password
      responses:
        "200":
          description: Successful login
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_id:
                    type: string
                  username:
                    type: string
                  xp:
                    type: integer
                  battlepass_xp:
                    type: integer
                  coins:
                    type: integer
                  gems:
                    type: integer
                  type:
                    type: string
                    enum:
                      - success
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/register":
    post:
      summary: User registration
      tags:
        - general
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                username:
                  type: string
                password:
                  type: string
              required:
                - email
                - username
                - password
      responses:
        "200":
          description: Successful registration
          content:
            application/json:
              schema:
                type: object
                properties:
                  session_id:
                    type: string
                  username:
                    type: string
                  type:
                    type: string
                    enum:
                      - success
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/logout":
    post:
      summary: User logout
      tags:
        - general
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful logout
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - success
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_user_id":
    get:
      summary: Get user ID
      tags:
        - general
      parameters:
        - name: session_id
          in: query
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - success
                  id:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_balance":
    post:
      summary: Get user balance
      tags:
        - shop
        - general
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - success
                  coins:
                    type: integer
                  gems:
                    type: integer
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_xp":
    post:
      summary: Get user xp and battlepass xp
      tags:
        - shop
        - general
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - success
                  xp:
                    type: integer
                  battlepass_xp:
                    type: integer
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "404":
          description: User Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    enum:
                      - fail
                  reason:
                    type: string
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_all_skins":
    get:
      summary: Get all available skins
      tags:
        - shop
        - skins
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                additionalProperties:
                  type: object
                  properties:
                    name:
                      type: string
                    price_coins:
                      type: integer
                    price_gems:
                      type: integer
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_user_skins":
    post:
      summary: Get user skins
      tags:
        - shop
        - skins
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  ids:
                    type: array
                    items:
                      type: string
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/buy_skin":
    post:
      summary: Buy skin
      tags:
        - shop
        - skins
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                skin_id:
                  type: string
                currency:
                  type: string
                  enum:
                    - coins
                    - gems
              required:
                - session_id
                - skin_id
                - currency
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  currency:
                    type: string
                    enum:
                      - coins
                      - gems
                  new_balance:
                    type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/buy_gems":
    post:
      summary: Buy gems
      tags:
        - shop
        - currency
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                gemsQuantity:
                  type: integer
              required:
                - session_id
                - gemsQuantity
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  new_balance:
                    type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/buy_battlepass":
    post:
      summary: Buy battle pass
      tags:
        - shop
        - battlepass
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  new_balance:
                    type: number
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: not logged in
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/battlepass_status":
    post:
      summary: Get battle pass status
      tags:
        - shop
        - battlepass
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  owned:
                    type: string
                    example: "true"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: not logged in
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_booster_count":
    post:
      summary: Get user's booster count
      tags:
        - shop
        - boosters
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  booster_count:
                    type: integer
                    example: 3
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: not logged in
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/buy_booster":
    post:
      summary: Buy a booster
      tags:
        - shop
        - boosters
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                currency:
                  type: string
                  enum:
                    - coins
                    - gems
              required:
                - session_id
                - currency
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  new_balance:
                    type: integer
                    example: 150
                  currency:
                    type: string
                    enum:
                      - coins
                      - gems
                    example: coins
                  booster_count:
                    type: integer
                    example: 3
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/set_avatar":
    post:
      summary: Set user's avatar
      tags:
        - shop
        - avatars
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                avatar_id:
                  type: integer
              required:
                - session_id
                - avatar_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_avatar":
    post:
      summary: Get user's avatar
      tags:
        - shop
        - avatars
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  avatar_id:
                    type: integer
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/get_user_avatars":
    post:
      summary: Get user's owned avatars
      tags:
        - shop
        - avatars
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
              required:
                - session_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
                  owned_avatars:
                    type: array
                    items:
                      type: integer
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: missing parameters
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/click_tile":
    post:
      summary: Click a tile in the game
      tags:
        - game
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                tile_id:
                  type: integer
              required:
                - session_id
                - tile_id
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: win
                  board:
                    type: object
                    additionalProperties:
                      type: integer
                      enum:
                        - -1
                        - 0
                        - 1
                        - 2
                        - 3
                        - 4
                        - 5
                        - 6
                        - 7
                        - 8
                        - 9
                        - 10
                  xp:
                    type: integer
                  added_xp:
                    type: integer
                  coins:
                    type: integer
                  added_coins:
                    type: integer
                  battlepass_xp:
                    type: integer
                  added_battlepass_xp:
                    type: integer
                  battlepass_reward:
                    type: string
                    enum:
                      - "true"
                      - "false"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: tile already clicked
                  board:
                    type: object
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: tile not found
                  board:
                    type: object
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
  "/create_game":
    post:
      summary: Create a new game
      tags:
        - game
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                session_id:
                  type: string
                size_x:
                  type: integer
                size_y:
                  type: integer
                difficulty:
                  type: string
                  enum:
                    - "1"
                    - "2"
                    - "3"
                    - "4"
                booster_used:
                  type: integer
                  enum:
                    - 0
                    - 1
              required:
                - session_id
                - size_x
                - size_y
                - difficulty
                - booster_used
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: success
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  type:
                    type: string
                    example: fail
                  reason:
                    type: string
                    example: wrong session id
        "500":
          description: Internal Server Error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
tags:
  - name: general
  - name: shop
  - name: skins
  - name: currency
  - name: battlepass
  - name: boosters
  - name: avatars
  - name: game
